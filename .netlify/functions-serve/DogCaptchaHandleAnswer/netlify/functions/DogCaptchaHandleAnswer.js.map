{
  "version": 3,
  "sources": ["../../../../../../Docker/react/dog-captcha/netlify/functions/DogCaptchaHandleAnswer.mjs"],
  "sourceRoot": "C:/Users/meijirou/AppData/Local/Temp/tmp-16708-drg75GZkb2Z5",
  "sourcesContent": ["{/* Handle POST request from client */}\r\n{/* http://localhost:9999/.netlify/functions/DogCaptchaHandleAnswer */}\r\n\r\nconst headers = {\r\n    \"Access-Control-Allow-Origin\" : \"https://astonishing-caramel-d77900.netlify.app\",  //Allowed URL to call API   * = All\r\n    \"Access-Control-Allow-Methods\": \"POST, DELETE\",\r\n    \"Access-Control-Allow-Headers\": \"Content-Type\"\r\n}  \r\n\r\nexports.handler = async function(event, context) {\r\n//export async function DogCaptchaHandleAnswer(event, context) {\r\n\r\n    //Read POST/DELETE Request\r\n    let data;\r\n    try {\r\n        data = event.body;\r\n    } catch (error) {\r\n        console.error(\"Error parsing JSON: \", error);\r\n        return { statusCode: 400, headers: headers, body: \"Invalid request body\" };\r\n    }\r\n\r\n    if (event.httpMethod === \"DELETE\") {\r\n\r\n        let database = await readDatabaseJSON();\r\n\r\n        let i;\r\n        for (i = 0; i < database.length; i++) { //Search for ID matched database index\r\n            if (JSON.parse(database[i]).id === JSON.parse(data).id) break;\r\n        }\r\n        if (i === database.length) i = -1;\r\n\r\n        if (i !== -1) DeleteSelectedFromDatabase(i);\r\n\r\n        return { statusCode: 200, headers: headers, body: JSON.stringify({ message: \"Requested API to Delete\" })};\r\n\r\n    } else if (event.httpMethod === 'OPTIONS') {\r\n\r\n        // Preflight request\r\n        return { statusCode: 200, headers: headers, body: 'This Was a Preflight Request' };\r\n\r\n    } else if (event.httpMethod !== \"POST\") {\r\n        return { statusCode: 405, headers: headers, body: \"Method Not Allowed. Only Allows POST or DELETE. Your Method Was \" + event.httpMethod + \".\" };\r\n    }\r\n\r\n\r\n    //POST\r\n    \r\n    //Read Database JSON\r\n    let database = await readDatabaseJSON();\r\n\r\n    //Search Answer from Database JSON\r\n    let searchResult = database.indexOf( JSON.stringify({id: JSON.parse(data).id, ans: Number(JSON.parse(data).ans)}) );\r\n    \r\n    if (searchResult !== -1) { \r\n        DeleteSelectedFromDatabase(searchResult);   //delete from database\r\n        return { statusCode: 200, headers: headers, body: JSON.stringify({ passFlag: 1, message: \"Data Received and CAPTCHA Passed\" })};\r\n    }\r\n    else return { statusCode: 200, headers: headers, body: JSON.stringify({ passFlag: 0, message: \"Data Received but CAPTCHA Failed\" })};\r\n};\r\n\r\nasync function readDatabaseJSON() {\r\n    const response = await fetch(\"https://roaring-pegasus-3652c3.netlify.app/.netlify/functions/DogCaptchaDatabase\");\r\n    const data = await response.json();\r\n    let JSONArray = data;\r\n\r\n    return JSONArray;\r\n}\r\n\r\n{/* DELETE */}\r\nfunction DeleteSelectedFromDatabase(index) {\r\n    const data = { index: index };\r\n    fetch('https://roaring-pegasus-3652c3.netlify.app/.netlify/functions/DogCaptchaDatabase', {\r\n    method: 'DELETE',\r\n    body: JSON.stringify(data),\r\n    headers: { 'Content-Type': 'application/json' },\r\n    })\r\n    .then(response => {\r\n    if (!response.ok) {\r\n        throw new Error(`${response.status} ${response.statusText}`);\r\n    }\r\n    return response.json();\r\n    })\r\n    .then(data => console.log(data))\r\n    .catch((error) => console.error('Error:', error));\r\n}"],
  "mappings": ";AAAA;AAAsC;AACtC;AAAsE;AAEtE,IAAM,UAAU;AAAA,EACZ,+BAAgC;AAAA;AAAA,EAChC,gCAAgC;AAAA,EAChC,gCAAgC;AACpC;AAEA,QAAQ,UAAU,eAAe,OAAO,SAAS;AAI7C,MAAI;AACJ,MAAI;AACA,WAAO,MAAM;AAAA,EACjB,SAAS,OAAO;AACZ,YAAQ,MAAM,wBAAwB,KAAK;AAC3C,WAAO,EAAE,YAAY,KAAK,SAAkB,MAAM,uBAAuB;AAAA,EAC7E;AAEA,MAAI,MAAM,eAAe,UAAU;AAE/B,QAAIA,YAAW,MAAM,iBAAiB;AAEtC,QAAI;AACJ,SAAK,IAAI,GAAG,IAAIA,UAAS,QAAQ,KAAK;AAClC,UAAI,KAAK,MAAMA,UAAS,CAAC,CAAC,EAAE,OAAO,KAAK,MAAM,IAAI,EAAE;AAAI;AAAA,IAC5D;AACA,QAAI,MAAMA,UAAS;AAAQ,UAAI;AAE/B,QAAI,MAAM;AAAI,iCAA2B,CAAC;AAE1C,WAAO,EAAE,YAAY,KAAK,SAAkB,MAAM,KAAK,UAAU,EAAE,SAAS,0BAA0B,CAAC,EAAC;AAAA,EAE5G,WAAW,MAAM,eAAe,WAAW;AAGvC,WAAO,EAAE,YAAY,KAAK,SAAkB,MAAM,+BAA+B;AAAA,EAErF,WAAW,MAAM,eAAe,QAAQ;AACpC,WAAO,EAAE,YAAY,KAAK,SAAkB,MAAM,qEAAqE,MAAM,aAAa,IAAI;AAAA,EAClJ;AAMA,MAAI,WAAW,MAAM,iBAAiB;AAGtC,MAAI,eAAe,SAAS,QAAS,KAAK,UAAU,EAAC,IAAI,KAAK,MAAM,IAAI,EAAE,IAAI,KAAK,OAAO,KAAK,MAAM,IAAI,EAAE,GAAG,EAAC,CAAC,CAAE;AAElH,MAAI,iBAAiB,IAAI;AACrB,+BAA2B,YAAY;AACvC,WAAO,EAAE,YAAY,KAAK,SAAkB,MAAM,KAAK,UAAU,EAAE,UAAU,GAAG,SAAS,mCAAmC,CAAC,EAAC;AAAA,EAClI;AACK,WAAO,EAAE,YAAY,KAAK,SAAkB,MAAM,KAAK,UAAU,EAAE,UAAU,GAAG,SAAS,mCAAmC,CAAC,EAAC;AACvI;AAEA,eAAe,mBAAmB;AAC9B,QAAM,WAAW,MAAM,MAAM,kFAAkF;AAC/G,QAAM,OAAO,MAAM,SAAS,KAAK;AACjC,MAAI,YAAY;AAEhB,SAAO;AACX;AAEA;AAAa;AACb,SAAS,2BAA2B,OAAO;AACvC,QAAM,OAAO,EAAE,MAAa;AAC5B,QAAM,oFAAoF;AAAA,IAC1F,QAAQ;AAAA,IACR,MAAM,KAAK,UAAU,IAAI;AAAA,IACzB,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,EAC9C,CAAC,EACA,KAAK,cAAY;AAClB,QAAI,CAAC,SAAS,IAAI;AACd,YAAM,IAAI,MAAM,GAAG,SAAS,MAAM,IAAI,SAAS,UAAU,EAAE;AAAA,IAC/D;AACA,WAAO,SAAS,KAAK;AAAA,EACrB,CAAC,EACA,KAAK,CAAAC,UAAQ,QAAQ,IAAIA,KAAI,CAAC,EAC9B,MAAM,CAAC,UAAU,QAAQ,MAAM,UAAU,KAAK,CAAC;AACpD;",
  "names": ["database", "data"]
}
